# Software/Platform Name/nVirtual simulation experiment: cluster construction and Keggin-type ion cluster mass spectrometry detection
Owner: Ning Zhang; Deli He; Miao Bian
1. College of Chemistry and Chemical Engineering, Hunan Normal University, Changsha, 410081, Hunan, P.R. China
2. College of Chemistry and Chemical Engineering, Central South University of Forestry and Technology, Changsha, 410004, Hunan, P.R. China
3. College of Materials Science and Engineering, Central South University of Forestry and Technology, Changsha, 410004, Hunan, P.R. China
4. College of Computer and Information Engineering, Central South University of Forestry and Technology, Changsha, 410004, Hunan, P.R. China

This software/platform has applied for copyright protection:
 ![image](https://github.com/user-attachments/assets/ce8648a9-b3dd-4239-b047-91f256f18f9e)

 
#  Abstract on the Software/Platform
Clusters, as a special material level between the macroscopic and microscopic, are of great significance for revealing chemical phenomena at the microscopic level. At the same time, due to their unique properties and functions, clusters have attracted widespread attention for their huge potential in applications such as catalyst design, new material synthesis, and drug development. However, the abstract complexity of cluster structures, as well as the high cost and high encapsulation of experimental mass spectrometry characterization instruments, make teaching and learning related to clusters challenging. With the rapid development of computer technology, virtual simulation experiments have become an effective means of teaching, learning, and research. It can present images and possible results in various extreme and complex environments through three-dimensional animations, human-computer interaction, and other methods, providing a low-cost, efficient, and intuitive way of teaching, learning, and researching.
Based on this, this work utilizes virtual simulation technology, including three-dimensional static/dynamic visualization, human-computer interaction, and other forms, using tools such as 3DS Max, Blender, Unity3D, and Visual Studio 2022, to design and develop an integrated virtual simulation experimental teaching software that combines cluster geometric construction theory, cluster solution structure research methods, and comprehensive analysis processes. It reproduces the entire process of studying the hydration dynamics of associative ion clusters and polyoxometalate ion clusters in aqueous solutions using electrospray time-of-flight mass spectrometry combined with theoretical calculations, with the aim of helping students better and more quickly build a physical image of the chemical intermediate microscopic world represented by clusters in their minds.
This work integrates, organizes, and connects the complex, interdisciplinary, and fragmented comprehensive methods and information involved in the study of conventional solution (cluster) structures. It achieves a high degree of restoration of the internal structure and working principles of large-scale equipment and instruments at a lower economic and time cost.  Through 3D animations and interactive operations, it effectively restores the research methods and comprehensive analysis processes of clusters, effectively making up for the limitations of traditional cluster teaching, learning, and research, such as lack of intuitiveness, cumbersome operation steps, high instrument costs, resource limitations, and high instrument encapsulation integration.  It provides students, teachers, researchers, and the public with an easy-to-understand and operate virtual platform for learning cluster knowledge. 
# Open Source Code and Component Usage Instructions
The code, models, and animations of this work are all original. The UI part uses open-source UI materials Sci-fi GUI skin and Dark Theme UI from the Unity Asset Store, and all other parts are original.

 
# Software/Platform Installation and Usage Instructions
GitHub Repository: EYuks/Cluster-Construction-and-Keggin-type-Ion-Cluster-Mass-Spectrometry-Detection (github.com)
1）Switch to the Master branch and download the ‘Cluster Construction and Keggin-type Ion Cluster Mass Spectrometry Detection.zip’ file completely, as shown in the figure below. 
![image](https://github.com/user-attachments/assets/26a268b1-b53c-4501-afcf-8bba88e8e8b8)

 
2) After fully extracting ‘Cluster Construction and Keggin-type Ion Cluster Mass Spectrometry Detection.zip’, double-click on ‘Virtual Simulation Experiment: Cluster Construction and Keggin-type Ion Cluster Mass Spectrometry Detection.exe’ to run the software.
 ![image](https://github.com/user-attachments/assets/018171d1-5cab-4367-807e-72f930f035e1)

3) Download the ‘Software Demonstration Video.mp4’ video. Watch the video to understand the software’s features and learn how to use it according to the guide.
4) ![image](https://github.com/user-attachments/assets/ccc8bd88-beb9-461b-a0ff-d05a3dbd1dbc)

 

 # Software/Platform Performance Demonstration
 ![image](https://github.com/user-attachments/assets/b089606e-6e50-4615-8793-e9e1416f2234)
![image](https://github.com/user-attachments/assets/4889070f-9218-40db-b8f0-fd342144b8c0)
![image](https://github.com/user-attachments/assets/ba63ef47-546d-43fb-b8e6-34e5b58a7ccc)
![image](https://github.com/user-attachments/assets/69e06347-c1e4-4574-82f2-7cf121309276)
![image](https://github.com/user-attachments/assets/cbb162d3-7395-4bce-9ce8-0542ef8bbbff)
![image](https://github.com/user-attachments/assets/96b8a05e-0ecf-43dc-b91d-6fcb5af03470)
![image](https://github.com/user-attachments/assets/8d712723-91cc-4659-a916-60d7b2be1ff5)
![image](https://github.com/user-attachments/assets/7cda9a07-a949-463a-8239-f5ff4aa7dd1d)
![image](https://github.com/user-attachments/assets/79731261-3b85-46ed-ac61-33f39bb24fcd)
![image](https://github.com/user-attachments/assets/c039407e-d65d-4c0f-bc9d-1cb44900cc48)
![image](https://github.com/user-attachments/assets/4f148605-f67d-46f4-b406-105d0cac9f80)

 
 
 # Software/Platform Advantages:
Advantages in overall design: The virtual simulation platform can vividly describe and visualize abstract cluster structures and the internal construction of instruments. This study uses three-dimensional animations to intuitively display cluster structures, allowing students to build cluster structures step by step through dragging and interactive operations, further deepening their understanding of abstract cluster structures. For example, 3DS MAX is used to accurately construct 3D configuration diagrams and dynamic assembly processes of multiple clusters. At the same time, by precisely reconstructing the three-dimensional structure inside the instrument, it detailed displays the internal structure and working principles of the instrument, breaking through the limitations of traditional two-dimensional plane instrument construction explanations. For instance, 3D animations vividly depict the series of processes that occur after the sample solution enters the instrument, such as ionization, filtration, screening, mass analysis, and detection imaging. Compared to traditional methods, virtual simulation provides a more comprehensive perspective, allowing students to understand abstract structures and the internal construction of instruments more meticulously through interactive operations such as rotation and zooming. In addition, it can also simulate the actual operation of the instrument, helping students to familiarize themselves with the process before operating the instrument, improving learning efficiency, and reducing operational risks.
Advantages in actual teaching process: Through virtual simulation experiments, students can understand the basic processes and analysis methods for studying solution structures in a relatively short period of time. The learning of cluster theory knowledge, the construction process, the establishment of molecular dynamics simulation physical models, the submission of computational assignments, the theoretical teaching process of post-processing simulation data, and the experimental teaching process of operating and analyzing data from electrospray time-of-flight mass spectrometers, which would take at least several months in traditional teaching models, can be effectively integrated through virtual simulation experiments. This allows the entire learning process to be completed in two class periods (approximately 100 minutes). At the same time, virtual simulation, with its highly accurate three-dimensional models and dynamic simulations, not only accelerates students’ understanding of solution structure-related theories and analysis processes but also enhances the intuitiveness and participation of students’ learning through real-time feedback and an operable simulation environment.
In particular, the virtual simulation platform reduces the need for students' prior knowledge. The step-by-step guided design process of the virtual simulation experiment allows students to start from basic knowledge and gradually explore deeper content without needing to master all related knowledge from the beginning. This progressive learning path is especially valuable for beginners because it ensures that students gradually build a knowledge framework in practice and naturally supplement and improve their understanding during the exploration process. At the same time, the simulation experiment, through three-dimensional presentation and interactive operations, allows students to explore and understand solution structures in a series of operations, rather than relying solely on abstract and dry classroom lectures and book learning. This hands-on learning method promotes students’ active participation in exploring chemical knowledge, thereby more comprehensively grasping chemical theories, especially in understanding complex mesoscale theories.
In summary, the virtual simulation platform, through its intuitive three-dimensional display and interactive learning experience, not only effectively integrates complex and fragmented knowledge to help students master the basic processes and analysis methods of solution structures in a short period of time but also deepens the understanding of chemical mesoscale theories with less dependence on prior knowledge. The application of this teaching strategy is of great educational significance for cultivating students’ independent thinking and problem-solving abilities, and it also provides new perspectives and possibilities for the future development of teaching and learning of chemical mesoscale theories.
 
# Software/Platform Design Concept
The virtual experiment platform aims to highly restore and reproduce the entire process of using electrospray time-of-flight mass spectrometry combined with theoretical calculations to simulate the hydration dynamics of associative ion clusters and polyoxometalate ion clusters in aqueous solutions through virtual simulation technology. Based on the aforementioned teaching needs and objectives, the work focuses on the virtual implementation of the following aspects, covering four parts: cluster geometric construction theory (cluster prior knowledge), cluster solution structure research methods (molecular dynamics module), experimental mass spectrometry detection, and comprehensive data analysis. The specific design concept and framework are shown in Figure 1:
1) For the two types of ion clusters in aqueous solutions, hydrated ion clusters, and polyoxometalate ion clusters, their structures are complex and diverse. Traditional language descriptions and simple illustrations are insufficient to fully display their unique characteristics.  Based on the core-shell structure of hydrated ion clusters and the key units of polyoxometalate ion clusters during clustering, an interactive cluster construction module (cluster prior knowledge) was designed.
2) In the actual molecular dynamics simulation process, the correct construction of the water box physical model is the first step to obtain effective output results, but the model construction steps are cumbersome.  To address this issue, an interactive water box physical model construction module (molecular dynamics module) was designed.
3) The key experimental characterization instrument, the electrospray time-of-flight mass spectrometer, is expensive and highly integrated, with limited resources in most schools.  Students’ normal experimental operation skills cannot be effectively trained, and understanding the internal working principles of the instrument is even more difficult. To address this issue, by reading the relevant instrument manuals, the key internal components of the instrument were restored, and a 3D animation of the instrument’s working principle (spectroscopic experiment module) was produced.
4) How to obtain key microscopic structural data from actual molecular dynamics simulation output data and mass spectrometry data, and then restore the behavior of ion clusters in aqueous solutions has always been a complex, prior knowledge-required comprehensive analysis task. To address this issue, a data post-processing interactive module was designed.
In addition, the molecular dynamics simulation module includes the simulation process of submitting jobs using Linux commands on a supercomputing platform to call Gromacs and CP2K software for calculations, and the experimental module restores the operation process of collecting spectral data by electrospray time-of-flight mass spectrometry.
In summary, the overall design scheme fully restores the conventional process of solution structure research, combs, integrates, and connects the fragmented information obtained from reality in terms of theory and experiment, forming a one-stop virtual learning platform that includes the construction ideas of two typical clusters (hydrated clusters, polyoxometalate ion clusters), various methods currently used to study solution structures,  and the outline and general process of comprehensive analysis.
![image](https://github.com/user-attachments/assets/25cfbdb1-9a02-403b-8072-36221572073b)
Figure 1: Overall design concept and framework of the project
 
# Software/Platform Design Focus and Difficulties
##  Design Focus and Final Effects (Partial Presentation)
For the overall design concept and framework of the project, the design focus of each module, task decomposition, implementation plan, and effects are as follows:
The cluster construction theory knowledge module integrates the basic geometric construction theory and basic coordination structure knowledge of hydrated ion clusters and polyoxometalate ion clusters. It visually demonstrates the construction process from basic building units to clusters through 3D animated demonstrations, providing students with a solid theoretical foundation. The basic coordination structure section offers more than 20 cluster construction models to choose from. Using Visual Studio 2022 based on C# programming, it realizes the step-by-step construction interaction process from atoms (points) to molecules (lines or surfaces) to basic building units (three-dimensional space) and finally to clusters, as shown in Figure 2.
![image](https://github.com/user-attachments/assets/9cd6589a-6aaf-42af-ba5a-46648edc14ec)
Figure 2: The virtual experimental platform constructed by this work, displaying the cluster construction theory knowledge module: (a) P1 represents the theoretical knowledge of hydrated ion cluster construction, and P2 represents the selectable parts of the ion cluster structure; (b) The step-by-step construction process of the Keggin-type phosphotungstic acid structure; (c) P1, P2 are the step-by-step construction diagrams of the MgF(H2O)5+ hydrated ion cluster, and P3, P4 are the step-by-step construction diagrams of the Keggin-type phosphotungstic acid.

2) In the cluster construction theoretical calculation module, the initial physical model construction, force field file explanation, pre-equilibrium operation, and the process of submitting tasks that are commonly involved in the simulation study of cluster behavior in solutions using classical molecular dynamics software are restored. This is achieved through the design of key command interaction, intelligent scoring, and textual prompt explanations, which enhances the user’s sense of immersion, as shown in Figure 3. 
 ![image](https://github.com/user-attachments/assets/209a9d4f-ca21-4df0-80a4-d6ddc0b95f0c)
Figure 3: The virtual experimental platform constructed by this work, displaying the cluster construction theoretical calculation module and the post-processing module for dynamic simulation data: (a) Explanation of the force field file and the water box model, with the left image showing the input of constraint conditions for the force field file and the right image showing the completed physical model of the water box; (b) The simulation page for submitting computational tasks; (c) The data post-processing page, where P1 and P2 represent the evolution process of the MgF(H2O)5+ hydrated ion cluster and the Keggin-type phosphotungstic acid, respectively, P3 is the radial distribution function graph in data analysis, and P4 is the association potential energy surface graph.

3) In the spectroscopic experimental characterization module, 3D modeling of seven important structures, including electrospray ionization and quadrupoles, was conducted using 3DS Max to recreate the key components and dynamic working principles inside the electrospray time-of-flight mass spectrometer. Through 3D animated demonstrations, the entire process from the introduction of the sample solution into the electrospray time-of-flight mass spectrometer to the display of the spectrum on the screen was visually presented, addressing issues such as high encapsulation integration and difficulty in observing the internal ion transport process. At the same time, a three-dimensional laboratory scene was constructed to virtually reproduce the mass spectrometry characterization process of sodium tungstate acidic solution experiments and the collection of mass spectrometry data. The design of highlights, interactive operations, practice, and assessment modes deepened students’ understanding of the mass spectrometry data collection experimental operations, as shown in Figures 4 and 5.
 ![image](https://github.com/user-attachments/assets/34da6284-06aa-40a4-8fb5-1ab434768307)

Figure 4: The virtual experimental platform constructed by this work, displaying the spectroscopic experimental characterization module: (a) P1 is the three-dimensional model of the electrospray time-of-flight mass spectrometer, P2 is the two-dimensional internal structure diagram of the electrospray time-of-flight mass spectrometer, and P3 is the three-dimensional internal structure diagram reconstructed in this study for the electrospray time-of-flight mass spectrometer; (b) The dynamic working principle of the electrospray time-of-flight mass spectrometer, where one can view the dynamic working principles and three-dimensional configurations of the key internal structures of the instrument.
 ![image](https://github.com/user-attachments/assets/0e41ff4f-8298-4b9e-8ff6-693562828407)

Figure 5: The virtual experimental platform constructed by this work, displaying the spectroscopic experimental characterization module: (a) The three-dimensional laboratory page includes a navigation bar, perspective switch, mouse operation instructions, score display, from which students can access various parts of learning resources. The right image is the experimental perspective diagram, with the dashed frame indicating the operation steps explanation. Inside the dashed frame on the left is the operation process dropdown box, and on the right are the specific implementation details of each operation process; (b) The experimental operation page; (c) The data analysis simulation page.

4) The data post-processing module includes statistical analysis of molecular dynamics simulation data, extraction of thermodynamic quantities, and analysis of mass spectrometry data. Both processes are designed with detailed analysis step instructions and interactive processes, replicating the entire data processing process of software such as VMD and Bruker DataAnalysis, as shown in Figures 3c and 5c.

## Design Challenges and Solutions
During the process of 3D model and animation production, and model import, issues such as missing parts, disorder, incomplete texture display, and unsmooth animation design were encountered. These were gradually resolved through self-analysis, consulting materials, seeking advice from peers, and repeated debugging. The main challenges and corresponding strategies are as follows:
1) Problems and solutions for missing and scattered parts during model import from different software When models built in 3DS Max are imported into Unity3D, issues such as missing parts, lost surfaces, and scattered components arise, which were found to be caused by model errors or chaotic normals. Solutions include degrouping the erroneous models, collapsing the entire model and regrouping, adjusting the normals, and re-exporting.
Problems and solutions for incomplete display of external textures in Unity3D For textures imported from 3DS Max that fail to display in Unity3D, it was discovered that the issue arises when the model and texture files are not placed in the same folder or at the same level. Therefore, textures are directly applied in 3DS Max, and the "Embed Media" option is selected when exporting the FBX file. For models that still fail to display textures, materials are reassigned in Unity3D.
2) Problems and solutions for difficult animation implementation, and unrealistic and unsmooth animation effects in Unity3D animation production.
a. In simulating the process of pouring liquid, it was difficult to achieve the liquid flow effect inside the bottle using Unity shaders.
b. In the theoretical calculation section, when inputting statements to judge correctness and display molecular models, the previous content was not covered after clicking the ‘Next Step’ button.
c. In the experimental operation design process, inserted videos failed to play.
d. Issues such as model shapes not meeting requirements, textures not being realistic enough, and unsmooth animation effects were analyzed and discussed. It was found that some were due to insufficient detail handling during the model construction phase leading to jagged rendering effects, some were due to unreasonable keyframe settings during the animation production phase leading to unsmooth animation effects, and some were due to misplaced keyframe sequences causing the video not to display after exporting with video clip. To address the series of animation production issues discovered, solutions were found by either increasing the subdivision count, adjusting keyframe intervals and adding intermediate frames for improvement, storing instructions and models in two separate arrays and displaying content based on the index when clicking buttons, or changing to the URL method and implementing path assignment through code, thus resolving the issues. 
#  Conclusion
This work, through virtual simulation technology, highly restores the geometric construction of cluster structures, the working principles of electrospray time-of-flight mass spectrometers, and the scenes and processes of spectroscopic experiments. With complete structural design, realistic internal details, and smooth 3D animations, it showcases the deep integration of computer science and chemistry. The completion of this work has overcome the practical obstacles of complex and abstract cluster structures, the high cost of large-scale instruments making it difficult to equip them in sufficient quantities, and the highly integrated and encapsulated nature of instruments making it challenging for students to understand. It innovates the teaching methods of instruments, breaks through spatial and temporal limitations, and immerses students in the experience. The realization of this work not only enables students to comprehensively grasp the geometric construction and properties of clusters, the internal structure and working principles of instruments, and enhances their ability to understand and explore the microscopic world of chemistry, but also cultivates a group of interdisciplinary talents combining computer science and chemical instruments. This contributes a modest effort to solving the ‘bottleneck’ issues such as the lag in the development of large-scale scientific research instruments in our country.
